Final code for Lori, Cipango, Crane, Factory, and Server